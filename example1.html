<!DOCTYPE html>
<html lang="en">
<head>
	<title>Raphael examples</title>
	<script src="raphael.js"></script>

</head>
<body>
	<div id="notepad"></div>
	<script>

	//array that contians the data values
	var dataValue = [];
	dataValue[0]= "100";
	dataValue[1]= "50";
	dataValue[2]= "(150)"; //negative numbers are stored with parenthesis
	dataValue[3]= "100";
	dataValue[4]= "500";

	

	var heightValue = []; //contains the difference in height between this bar and the previous bar

	for(var j =0,jj=dataValue.length; j<jj; j++){
		if(j==0){
			heightValue[j]=parseFloat(dataValue[j]);
		}else{
			if(dataValue[j].search(/\(/) !== -1){ //if we have a negative number
				dataValue[j] = dataValue[j].replace(/\(|\)/g,"");
				dataValue[j] = parseFloat(dataValue[j]);
				dataValue[j] = (-1)*dataValue[j];
			}else{
				dataValue[j] = parseFloat(dataValue[j]);
			}
			heightValue[j] = dataValue[j]-dataValue[j-1];	
		}
		
	}

	console.log("typeof "+typeof(heightValue));

	var paperHeight = 600;


	var paper = Raphael(50, 50, 800, paperHeight);
	// Canvas is created at the top left corner of the #notepad element
	// (or its top right corner in dir="rtl" elements)

	// Same as above
	var startFromX = 30;
	var startFromY = 400;
	var width = 100;
	var x = 40;
	var y = 0;
	var height = 0;
	var startFromBottom = false;



	function makeBar(x,y,w,h,color){
		c = paper.rect(x,y,w,h).attr({
			stroke: color,
			fill: "210-"+color+"-#333"
		});
	}

	function makeGrid(){
		c = paper.path("M30 10 L30 800 M30 410 L800 410");
		for(var i=10,ii=1000; i<ii; i+=50){
			c = paper.path("M25 "+i+" L40 "+i+"");
			//c = paper.text(15, i, i);
		}

		for(var j=40,jj=1000; j<jj; j+=50){
			c = paper.path("M"+j+" 390 L"+j+" 410");
		}
	}

	function sumTotBar(){
		console.log("im in sumTotBar");
		var acum = 0;
		for(var i=0,ii=heightValue.length; i<ii; i++){
			acum +=heightValue[i];
		}
		console.log("acum "+acum);

		y = startFromY - acum;

		console.log("y "+y);
		color = '#0000ff';
		if(acum == 0){
			acum = 1;
		}else if(acum<0){
			acum = (-1)*acum;
		}
		makeBar(x,y+10,width,acum,color);
		
	}

	makeGrid();

	for(var i=0,ii=dataValue.length; i<ii; i++){

		if(i==0){//the first bar is different from the rest because it has nothing to compare to
			y = startFromY - dataValue[i];
			height = dataValue[i];
			color = '#00ff00';
		}else{
			if(heightValue[i]<0){
				y = startFromY - dataValue[i-1];
				height = heightValue[i] *(-1);
				color = '#ff0000';
			}else{
				y = startFromY - dataValue[i];
				height = heightValue[i];
				color = '#00ff00';
			}
			
		}

		makeBar(x,y+10,width,height,color);

		x+=110;	
		
	}	

	sumTotBar();



	</script>
</body>
</html>